<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>分切成品出仓</title>
    <script src="bootstrap-3.3.7-dist/js/jquery-3.1.1.min.js" type="text/javascript" charset="utf-8"></script>
    <link href="bootstrap-3.3.7-dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="bootstrap-3.3.7-dist/js/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="login.css">
    <link rel="stylesheet" type="text/css" href="erp.css"/>

</head>
<body>
<div id="container" class="cf">
    <div class="layoutCls">
        <div class="left-menu">
            <ul class="nav nav-pills nav-stacked">
                <li>
                    <h1 style="color: #EEEEEE;"> &nbsp;&nbsp;隆 楷</h1></li>
                <li>
                    <a href="main.html" role="button" >
                        <span class="glyphicon glyphicon-home">&nbsp;&nbsp;首页&nbsp;</span>
                    </a>
                </li>
                <li>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-gift">&nbsp;&nbsp;采购&nbsp;</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="purchaseplan.html">采购计划</a></li>
                        <li><a href="purchaseList.html">采购单</a></li>
                    </ul>
                </li>
                <li>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-ok-circle">&nbsp;&nbsp;销售&nbsp;</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="saleBook.html">销售确认书</a></li>
                        <li><a href="offPrice.html">特价表</a></li>
                    </ul>
                </li>
                <li  class="active">
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-list-alt">&nbsp;&nbsp;仓库&nbsp;</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="putInStorage.html">进仓单</a></li>
                        <li><a href="分切出仓修改.html">分切出仓单</a></li>
                        <li><a href="fqcp.html">分切成品出仓单</a></li>
                        <li><a href="出仓单.html">出仓单</a></li>
                        <li><a href="出仓单查询2.html">出仓单查询</a></li>
                        <li><a href="验货单.html">验货单</a></li>
                        <li><a href="验货单查询2.html">验货单查询</a></li>
                        <li><a href="问题表.html">问题表</a></li>
                        <li><a href="问题表查询2.html">问题表查询</a></li>
                    </ul>
                </li>
                <li>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        <span class="glyphicon glyphicon-font">&nbsp;&nbsp;资金&nbsp;</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="shouldGet.html">应收款明细表</a></li>
                        <li><a href="shouldPaid.html">应付款明细表</a></li>
                    </ul>
                </li>
                <li>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        <i class="icon-error"></i>
                        <span class="glyphicon glyphicon-remove">&nbsp;&nbsp;资料&nbsp;</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="商品.html">商品管理</a></li>
                         <li><a href="商品查询.html">商品管理查询</a></li>
                        <li><a href="客户.html">客户管理</a></li>
                         <li><a href="客户查询.html">客户管理查询</a></li>
                        <li><a href="供应商.html">供应商管理</a></li>
                         <li><a href="供应商查询.html">供应商管理查询</a></li>
                        <li><a href="职员管理.html">职员管理</a></li>
                        <li><a href="职员管理查询.html">职员管理查询</a></li>
                    </ul>
                </li>
                <li>
                    <a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
                        <i class="icon-review"></i>
                        <span class="glyphicon glyphicon-file">&nbsp;&nbsp;设置&nbsp;</span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a href="system.html">系统参数设置</a></li>
                        <li><a href="storehouse.html">仓库管理</a></li>
                    </ul>
                </li>
            </ul>
        </div>
        <div class="default-main" style="left:129px;">
            <div class="main-hd cf">
                <div class="right">
                    <ul class="advanced-menu cf left">
                        <li style="position: relative">
                            <a href="login.html"style="color: #000000;text-decoration:none">退出</a>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="main-bd" style="height: 632px;">
                <div class="wcsearch" style="padding-left: 35%;">
                    <form class="form-inline" style="display: inline;">
                        <div class="form-group">
                            <label for="exampleInputName2">出仓单号</label>
                            <input type="text" class="form-control" name="outno" placeholder="S20180107">
                        </div>
                        <!--<div class="form-group">
                            <label for="exampleInputEmail2">至</label>
                            <input type="text" class="form-control" id="exampleInputEmail2" name="endTime" placeholder="2018-01-04">
                        </div>-->

                    </form>
                    <button type="submit" class="btn btn-default" onclick="searchorder()">查询</button>
                    <button class="btn btn-default" onclick="addorder()">新增</button>
                </div>
                <div class="rec_container" style="height: 632px; display: block;">
                    <div class="no"> 请输入出仓单号查询或新增</div>
                    <div class="ui-print" style="display: none;">
                        <div class="wtitle">分切成品出仓单</div>
                        <div class="grid-wrap" style="position:relative;">
                            <!--最外层form-->
                            <form class="form-inline">
                                <div style="display: block;">
                                    <div style="float: left;margin-left:10px ;margin-bottom: 30px">

                                        <div class="form-group" style="display: block;">
                                            <label for="exampleInputName2"style="">成品出仓日期: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label>
                                            <input type="text" class="form-control" placeholder="2018-01-01"  name="ordertime">
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 20px;">
                                    <table class="table table-bordered table-hover l">
                                        <thead style="color:rgba(33, 32, 26, 0.81)" id="cut">
                                        <tr>
                                            <th>出仓单号</th>
                                            <th>商品编号</th>
                                            <th>数量</th>
                                            <th>重量</th>
                                            <th>单价</th>
                                            <th>客户编号</th>
                                            <th>职员编号</th>
                                            <th>总价</th>
                                            <th>件号</th>
                                        </tr>
                                        </thead>
                                    </table>
                                </div>
                            </form>
                            <button style="margin-top: 10px;  float: right;" type="submit" class="btn btn-default" onclick="save()">保存</button>
                            <!--最外层form结束-->
                            <button style="margin-top: 10px;" class="btn btn-default" onclick="addrow()">增加一行</button>
                            <button style="margin-top: 10px;" class="btn btn-default" onclick="deleterow()">删除一行</button>
                        </div>
                    </div>
                    <div class="ui-print" style="display: none;">
                        <div class="grid-wrap">
                            <table class="table table-bordered table-hover">
                                <thead style="color:rgba(33, 32, 26, 0.81)" id="search">
                                <tr>
                                    <th>出仓单号</th>
                                    <th>客户编号</th>
                                    <th>职员编号</th>
                                    <th>总价</th>
                                    <th>件号</th>
                                </tr>
                                </thead>
                            </table>
                            <!--<form class="form-inline">-->
                                <!--<div class="form-group">-->
                                    <!--<label for="deleteno">删除的出仓单号:</label>-->
                                    <!--<input type="text" class="form-control" id="deleteno" name="deleteno" placeholder="0001">-->
                                <!--</div>-->
                            <!--</form>-->
                            <!--<button class="btn btn-default" onclick="deleteno()">删除</button>-->
                        </div>
                    </div>
                    <div class="attention" style="display:none">保存成功</div>
                    <div class="attention2" style="display:none">无记录</div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>
<script type="text/javascript">
    var count = 0;
    function addrow(){
        count++;
        alert(count);
//		var $a = $("#a").clone();
//		$("#saleb").append($a);
        var html='<tr>';
        html += '<td><input size="8" name="outno'+ count+'"></td>' + '<td><input size="8" name="productID'+ count+'"></td>' + '<td><input size="8" name="num'+ count+'"></td>' +'<td><input size="8" name="weight'+ count+'"></td>' + '<td><input size="8" name="price'+ count+'"></td>' + '<td><input size="8" name="customerID'+ count+'"></td>' + '<td><input size="8" name="employeeID'+ count+'"></td>' + '<td><input size="8" name="total'+ count+'"></td>'+ '<td><input size="8" name="jh'+ count+'"></td>' +'</tr>';
        $("#cut").append(html);
        var i = 1;
        $(".td").each(function(){       //增加一行后重新更新序号1,2,3......
            $(this).html(i++);
        });
        $(".l tr:last").find(":input").val('');   //将尾行元素克隆来的保存的值清空
    }
    function deleterow(){
        if(count == 0) {
            alert("没有新增");
            return;
        }
        else{
            $(".l tr:last").remove();
            count--;
        }
    }
    function deleteno(){
        var orderno = $('.deleteno').val();
        $.ajax({
            type:"GET",
            data:{"type":"delete","orderno":orderno},
            url:"purchasePlan.php",
            dataType:'json',
            success:function(data){
                if (data.success) {
                    alert("删除成功！");
                    //searchbook();
                }
                else
                {
                    alert("题目传输出错");
                }
            },
            error:function(data){
                alert("wrong!");
            }

        })
    }
    function searchorder(){
        $("#search").siblings().remove();
        $.ajax({
            type:"GET",
            url:'searchFQCP.php',
            data:$("form").serialize(),
            dataType:'json',
            success:function (data) {
                if (data.success) {
                    $('.no').hide();

                    var list = data.list;
                    var html='<tbody><tr>';
                    for (var i = 0, len = list.length; i < len; i++) {
                        html += '<td>' + list[i].outno + '</td>' + '<td>' + list[i].productID+ '</td>' +  '<td>' + list[i].employeeID+ '</td>' + '<td>' + list[i].total+ '</td>' + '<td>' + list[i].jh+'</td>' + '</tr>'
                        if(len != i+1)
                            html += '<tr>';
                    }
                    html+='</tbody>';

                    $("#search").after(html);
                    $('.rec_container>div').eq(1).hide();
                    $('.rec_container>div').eq(2).show();
                }
                else{
                    $('.attention2').show();
                }
            },
            error:function(data){
                alert("数据没传过来!");
            }
        })
    }
    function addorder(){
        $('.rec_container>div').eq(1).show();
        $('.rec_container>div').eq(2).hide();
    }

    function save() {
        if(count == 0){
            alert("没有新增内容");
            return;
        }
        $.ajax({
            type:"post",
            url:"fqcp.php",
            data:$("form").serialize(),
            dataType:"json",
            //async:false,
            success:function(data){ //不用传success=》true
                if(data.success){
                    $('.attention').show();
                }
                else{
                    alert("保存失败");
                }
            },
            /*error:function(){
             alert("结果错误！");
             }*/
            error: function(XMLHttpRequest, textStatus, errorThrown) {
                alert(XMLHttpRequest.status);
                alert(XMLHttpRequest.readyState);
                alert(textStatus);
            },

        })
    }
</script>

